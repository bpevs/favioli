/**
 * Used for enableAutofillFavicon.
 * Automatically selects an emoji,and uses it to replace the favicon.
 */

const isWindows = /^Win\d+$/.test(navigator.platform);

// deno-fmt-ignore
const emojis = ("\
ðŸ˜€ ðŸ˜ ðŸ˜‚ ðŸ¤£ ðŸ˜ƒ ðŸ˜„ ðŸ˜… ðŸ˜† ðŸ˜‰ ðŸ˜Š ðŸ˜‹ ðŸ˜Ž ðŸ˜ ðŸ˜˜ ðŸ˜— ðŸ˜™ ðŸ˜š ðŸ™‚ ðŸ¤— ðŸ¤© ðŸ¤” ðŸ¤¨ ðŸ˜ \
ðŸ˜‘ ðŸ˜¶ ðŸ™„ ðŸ˜ ðŸ˜£ ðŸ˜¥ ðŸ˜® ðŸ¤ ðŸ˜¯ ðŸ˜ª ðŸ˜« ðŸ˜´ ðŸ˜Œ ðŸ˜› ðŸ˜œ ðŸ˜ ðŸ¤¤ ðŸ˜’ ðŸ˜“ ðŸ˜” ðŸ˜• ðŸ™ƒ ðŸ¤‘ \
ðŸ˜² â˜¹ï¸ ðŸ™ ðŸ˜– ðŸ˜ž ðŸ˜Ÿ ðŸ˜¤ ðŸ˜¢ ðŸ˜¦ ðŸ˜§ ðŸ˜¨ ðŸ˜© ðŸ¤¯ ðŸ˜¬ ðŸ˜° ðŸ˜³ ðŸ¤ª ðŸ˜µ ðŸ˜¡ ðŸ˜  ðŸ¤¬ ðŸ˜· ðŸ¤’ \
ðŸ¤• ðŸ¤¢ ðŸ¤® ðŸ¤§ ðŸ˜‡ ðŸ¤  ðŸ¤¡ ðŸ¤¥ ðŸ¤« ðŸ¤­ ðŸ§ ðŸ¤“ ðŸ˜ˆ ðŸ‘¿ ðŸ‘¹ ðŸ‘º ðŸ’€ ðŸ‘» ðŸ‘½ ðŸ¤– ðŸ’© ðŸ˜º ðŸ˜¸ \
ðŸ˜¹ ðŸ˜» ðŸ˜¼ ðŸ˜½ ðŸ™€ ðŸ˜¿ ðŸ˜¾ ðŸ‘¶ ðŸ‘¦ ðŸ‘§ ðŸ‘¨ ðŸ‘© ðŸ‘´ ðŸ‘µ ðŸ¤³ ðŸ’ª ðŸ‘ˆ ðŸ‘‰ â˜ï¸ ðŸ‘† ðŸ–• ðŸ‘‡ âœŒï¸ \
ðŸ¤ž ðŸ–– ðŸ¤˜ ðŸ– âœ‹ ðŸ‘Œ ðŸ‘ ðŸ‘Ž ðŸ‘Š ðŸ¤› ðŸ¤œ ðŸ¤š ðŸ‘‹ ðŸ¤Ÿ âœï¸ ðŸ‘ ðŸ‘ ðŸ™Œ ðŸ¤² ðŸ™ ðŸ¤ ðŸ’… ðŸ‘‚ \
ðŸ‘ƒ ðŸ‘£ ðŸ‘€ ðŸ‘ ðŸ§  ðŸ‘… ðŸ‘„ ðŸ’‹ ðŸ‘“ ðŸ•¶ ðŸ‘” ðŸ‘• ðŸ‘– ðŸ§£ ðŸ§¤ ðŸ§¥ ðŸ§¦ ðŸ‘— ðŸ‘˜ ðŸ‘™ ðŸ‘š ðŸ‘› ðŸ‘œ \
ðŸ‘ ðŸŽ’ ðŸ‘ž ðŸ‘Ÿ ðŸ‘  ðŸ‘¡ ðŸ‘¢ ðŸ‘‘ ðŸ‘’ ðŸŽ© ðŸŽ“ ðŸ§¢ â›‘ ðŸ’„ ðŸ’ ðŸŒ‚ ðŸ’¼ ðŸ¶ ðŸ± ðŸ­ ðŸ¹ ðŸ° ðŸ¦Š \
ðŸ» ðŸ¼ ðŸ¨ ðŸ¯ ðŸ¦ ðŸ® ðŸ· ðŸ½ ðŸ¸ ðŸµ ðŸ™Š ðŸ™‰ ðŸ™Š ðŸ’ ðŸ” ðŸ§ ðŸ¦ ðŸ¤ ðŸ£ ðŸ¥ ðŸ¦† ðŸ¦… ðŸ¦‰ \
ðŸ¦‡ ðŸº ðŸ— ðŸ´ ðŸ¦„ ðŸ ðŸ› ðŸ¦‹ ðŸŒ ðŸš ðŸž ðŸœ ðŸ•· ðŸ•¸ ðŸ¢ ðŸ ðŸ¦Ž ðŸ¦‚ ðŸ¦€ ðŸ¦‘ ðŸ™ ðŸ¦ ðŸŸ \
ðŸ¡ ðŸ¬ ðŸ¦ˆ ðŸ³ ðŸ‹ ðŸŠ ðŸ† ðŸ… ðŸƒ ðŸ‚ ðŸ„ ðŸ¦Œ ðŸª ðŸ« ðŸ˜ ðŸ¦ ðŸ¦ ðŸŽ ðŸ– ðŸ ðŸ ðŸ‘ ðŸ• \
ðŸ© ðŸˆ ðŸ“ ðŸ¦ƒ ðŸ•Š ðŸ‡ ðŸ ðŸ€ ðŸ¿ ðŸ¾ ðŸ‰ ðŸ² ðŸŒµ ðŸŽ„ ðŸŒ² ðŸŒ³ ðŸŒ´ ðŸŒ± ðŸŒ¿ â˜˜ï¸ ðŸ€ ðŸŽ ðŸŽ‹ \
ðŸƒ ðŸ‚ ðŸ ðŸ„ ðŸŒ¾ ðŸ’ ðŸŒ· ðŸŒ¹ ðŸ¥€ ðŸŒ» ðŸŒ¼ ðŸŒ¸ ðŸŒº ðŸŒŽ ðŸŒ• ðŸŒš ðŸŒ ðŸŒž ðŸŒœ ðŸŒ™ ðŸ’« â­ï¸ ðŸŒŸ \
âœ¨ âš¡ï¸ ðŸ”¥ ðŸ’¥ â˜„ï¸ â˜€ï¸ ðŸŒ¤ â›…ï¸ ðŸŒ¥ ðŸŒ¦ ðŸŒˆ â˜ï¸ â›„ï¸ â„ï¸ ðŸŒ¬ ðŸ’¨ ðŸŒª ðŸŒ« ðŸŒŠ ðŸ’§ ðŸ’¦ â˜” ðŸ \
ðŸŽ ðŸ ðŸŠ ðŸ‹ ðŸŒ ðŸ‰ ðŸ‡ ðŸ“ ðŸˆ ðŸ’ ðŸ‘ ðŸ ðŸ¥ ðŸ¥‘ ðŸ… ðŸ† ðŸ¥’ ðŸ¥• ðŸŒ½ ðŸŒ¶ ðŸ¥” ðŸ  ðŸŒ° \
ðŸ¥œ ðŸ¯ ðŸ¥ ðŸž ðŸ¥– ðŸ§€ ðŸ¥š ðŸ³ ðŸ¥“ ðŸ¥ž ðŸ¤ ðŸ— ðŸ– ðŸ• ðŸŒ­ ðŸ” ðŸŸ ðŸ¥™ ðŸŒ® ðŸŒ¯ ðŸ¥— ðŸ¥˜ ðŸ \
ðŸœ ðŸ² ðŸ¥ ðŸ£ ðŸ± ðŸ› ðŸš ðŸ™ ðŸ˜ ðŸ¢ ðŸ¡ ðŸ§ ðŸ¨ ðŸ¦ ðŸ° ðŸŽ‚ ðŸ® ðŸ­ ðŸ¬ ðŸ« ðŸ¿ ðŸ© ðŸª \
ðŸ¥› ðŸ¼ â˜•ï¸ ðŸµ ðŸ¶ ðŸº ðŸ¥‚ ðŸ· ðŸ¥ƒ ðŸ¸ ðŸ¹ ðŸ¾ ðŸ¥„ ðŸ´ ðŸ½ âš½ï¸ ðŸ€ ðŸˆ âš¾ï¸ ðŸŽ¾ ðŸ ðŸ‰ ðŸŽ± \
ðŸ“ ðŸ¸ ðŸ¥… ðŸ’ ðŸ‘ ðŸ â›³ï¸ ðŸ¹ ðŸŽ£ ðŸ¥Š ðŸ¥‹ â›¸ ðŸ† ðŸŽª ðŸ¤¹â€ ðŸŽ­ ðŸŽ¨ ðŸŽ¬ ðŸŽ¤ ðŸŽ§ ðŸŽ¼ ðŸŽ¹ ðŸ¥ \
ðŸŽ· ðŸŽº ðŸŽ¸ ðŸŽ» ðŸŽ² ðŸŽ¯ ðŸŽ³ ðŸŽ® ðŸŽ° ðŸš— ðŸš• ðŸš™ ðŸšŒ ðŸšŽ ðŸŽ ðŸš“ ðŸš‘ ðŸš’ ðŸš ðŸšš ðŸš› ðŸšœ ðŸ›´ \
ðŸš² ðŸ›µ ðŸ ðŸš¨ ðŸš” ðŸš ðŸš˜ ðŸš– ðŸš¡ ðŸš  ðŸšŸ ðŸšƒ ðŸš‹ ðŸšž ðŸš ðŸš„ ðŸš… ðŸšˆ ðŸš‚ ðŸš† ðŸš‡ ðŸšŠ ðŸš‰ \
ðŸš ðŸ›© âœˆï¸ ðŸ›« ðŸ›¬ ðŸš€ ðŸ›° ðŸ’º ðŸ›¶ â›µï¸ ðŸ›¥ ðŸš¤ ðŸ›³ â›´ ðŸš¢ âš“ï¸ ðŸš§ â›½ï¸ ðŸš ðŸš¦ ðŸš¥ ðŸ—º ðŸ—¿ \
ðŸ—½ â›²ï¸ ðŸ—¼ ðŸ° ðŸ¯ ðŸŸ ðŸŽ¡ ðŸŽ¢ ðŸŽ  â›± ðŸ– ðŸ ðŸ” ðŸ—» ðŸŒ‹ ðŸœ ðŸ• â›ºï¸ ðŸ›¤ ðŸ›£ ðŸ— ðŸ­ ðŸ  \
ðŸ¢ ðŸ› â›ªï¸ ðŸ•Œ ðŸ• ðŸ•‹ â›© â¤ï¸ ðŸ’” ðŸ™Ž ðŸ™… ðŸ™† ðŸ’ ðŸ™‹ ðŸ™‡ ðŸ¤¦ ðŸ¤· ðŸ’† ðŸ’‡ ðŸš¶ ðŸƒ ðŸ’ƒ ðŸ•º \
ðŸ‘¯ ðŸ§–â€ ðŸ‘©â€ðŸ‘§â€ðŸ‘§")
  .concat(isWindows ? "ðŸ±â€ðŸ’»" : "") // Only Windows has hacker cat
  .filter(emoji => emoji && emoji.trim());

/**
 * Create an emoji, based on our location
 */
export default function pickAutofillFavicon() {
  const host = location.host;
  const emojiIndex = Math.abs(sdbm(host)) % emojis.length;
  return emojis[emojiIndex];
}

/* tslint:disable no-bitwise */
/**
 *  Non-cryptographic hashing to get the same emoji index for different keys
 *  @source http://www.cse.yorku.ca/~oz/hash.html
 *  @source https://github.com/sindresorhus/sdbm
 *  @param {any} key
 *  @return {number} index
 */
function sdbm(key) {
  return String(key).split("").reduce((hash, char, i) => {
    const charCode = key.charCodeAt(i);
    return charCode + (hash << 6) + (hash << 16) - hash;
  }, 0) >>> 0;
}
/* tslint:enable no-bitwise */
